{% extends "base.html" %}

{% block title %}{{ username }}'s Open Source Report Card{% endblock %}

{% block body %}

<div class="profile-badge clearfix">
    <img height="50" width="50" alt="{{ username }}" class="avatar" src="https://secure.gravatar.com/avatar/{{ gravatar }}?s=220&d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png">
    <span class="profile-name">{{ name }}</span>
</div>
<div id="description">
</div>

<script type="text/html" id="description-template">
    <p><%= summary %></p>
</script>

<div id="week"></div>

{% endblock %}

{% block scripts %}

<script src="{{ url_for(".static", filename="d3.v3.min.js") }}"></script>
<script src="{{ url_for(".static", filename="underscore-min.js") }}"></script>
<script src="{{ url_for(".static", filename="jquery-1.9.1.min.js") }}"></script>
<script src="{{ url_for(".static", filename="plot.js") }}"></script>
<script>

d3.json("{{ url_for(".get_stats", username=username) }}?firstname={{ firstname }}", function (data) {

    // Display description.
    var template = _.template($("#description-template").html());
    $("#description").html(template(data));

    var week_hist = window.histogram().labels(["S","M","T","W","T","F","S"]);
    d3.select("#week").datum(data.week[0][1]).call(week_hist);

});

</script>

{% endblock %}
